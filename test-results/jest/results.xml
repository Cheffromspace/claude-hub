<?xml version="1.0" encoding="UTF-8"?>
<testsuites name="jest tests" tests="10" failures="5" errors="0" time="0.249">
  <testsuite name="GitHub Controller - Check Suite Events" errors="0" failures="5" skipped="2" timestamp="2025-05-26T02:03:00" time="0.228" tests="10">
    <testcase classname="GitHub Controller - Check Suite Events should trigger PR review when check suite succeeds with PRs and combined status passes" name="GitHub Controller - Check Suite Events should trigger PR review when check suite succeeds with PRs and combined status passes" time="0.004">
    </testcase>
    <testcase classname="GitHub Controller - Check Suite Events should not trigger PR review when check suite fails" name="GitHub Controller - Check Suite Events should not trigger PR review when check suite fails" time="0">
    </testcase>
    <testcase classname="GitHub Controller - Check Suite Events should not trigger PR review when check suite succeeds but has no PRs" name="GitHub Controller - Check Suite Events should not trigger PR review when check suite succeeds but has no PRs" time="0">
    </testcase>
    <testcase classname="GitHub Controller - Check Suite Events should handle multiple PRs in check suite in parallel" name="GitHub Controller - Check Suite Events should handle multiple PRs in check suite in parallel" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledTimes(expected)

Expected number of calls: 2
Received number of calls: 0
    at Object.toHaveBeenCalledTimes (/home/jonflatt/source/claude-hub/test/unit/controllers/githubController-check-suite.test.js:269:49)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="GitHub Controller - Check Suite Events should handle Claude service errors gracefully" name="GitHub Controller - Check Suite Events should handle Claude service errors gracefully" time="0.002">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

- Expected
+ Received

  Object {
-   &quot;context&quot;: Object {
-     &quot;checkSuite&quot;: 12345,
-     &quot;conclusion&quot;: &quot;success&quot;,
-     &quot;repo&quot;: &quot;owner/repo&quot;,
-     &quot;results&quot;: Array [
-       Object {
-         &quot;error&quot;: &quot;Claude service error&quot;,
-         &quot;prNumber&quot;: 42,
-         &quot;skippedReason&quot;: null,
-         &quot;success&quot;: false,
-       },
-     ],
-   },
-   &quot;message&quot;: &quot;Check suite processed: 0 reviewed, 1 failed, 0 skipped&quot;,
-   &quot;success&quot;: true,
+   &quot;message&quot;: &quot;Webhook processed successfully&quot;,
  },

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/jonflatt/source/claude-hub/test/unit/controllers/githubController-check-suite.test.js:355:26)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="GitHub Controller - Check Suite Events should skip PR when head.sha is missing" name="GitHub Controller - Check Suite Events should skip PR when head.sha is missing" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

- Expected
+ Received

  Object {
    &quot;context&quot;: Object {
      &quot;checkSuite&quot;: 12345,
      &quot;conclusion&quot;: &quot;success&quot;,
+     &quot;headBranch&quot;: &quot;feature-branch&quot;,
      &quot;repo&quot;: &quot;owner/repo&quot;,
-     &quot;results&quot;: Array [
-       Object {
-         &quot;error&quot;: &quot;Missing PR head SHA&quot;,
-         &quot;prNumber&quot;: 42,
-         &quot;skippedReason&quot;: &quot;No commit SHA available&quot;,
-         &quot;success&quot;: false,
    },
-     ],
-   },
-   &quot;message&quot;: &quot;Check suite processed: 0 reviewed, 0 failed, 1 skipped&quot;,
+   &quot;message&quot;: &quot;Check suite completed but no PRs found in payload&quot;,
    &quot;success&quot;: true,
  },

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/jonflatt/source/claude-hub/test/unit/controllers/githubController-check-suite.test.js:412:26)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="GitHub Controller - Check Suite Events should skip PR review when combined status is not success" name="GitHub Controller - Check Suite Events should skip PR review when combined status is not success" time="0">
      <skipped/>
    </testcase>
    <testcase classname="GitHub Controller - Check Suite Events should handle combined status API errors" name="GitHub Controller - Check Suite Events should handle combined status API errors" time="0">
      <skipped/>
    </testcase>
    <testcase classname="GitHub Controller - Check Suite Events should handle mixed success and failure in multiple PRs" name="GitHub Controller - Check Suite Events should handle mixed success and failure in multiple PRs" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledTimes(expected)

Expected number of calls: 2
Received number of calls: 0
    at Object.toHaveBeenCalledTimes (/home/jonflatt/source/claude-hub/test/unit/controllers/githubController-check-suite.test.js:608:49)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="GitHub Controller - Check Suite Events should skip PR review when already reviewed at same commit" name="GitHub Controller - Check Suite Events should skip PR review when already reviewed at same commit" time="0">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: {&quot;commitSha&quot;: &quot;pr-sha-123&quot;, &quot;prNumber&quot;: 42, &quot;repoName&quot;: &quot;repo&quot;, &quot;repoOwner&quot;: &quot;owner&quot;}

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/jonflatt/source/claude-hub/test/unit/controllers/githubController-check-suite.test.js:693:49)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
  </testsuite>
</testsuites>